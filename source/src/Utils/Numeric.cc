/*
 *
 * Numeric.cc cpp file template generated by fclass
 * Creation date : Fri Mar 15 14:10:39 2013
 * Copyright (c) CNRS / IPNL
 * All Right Reserved.
 *
 * Use and copying of these libraries and preparation of derivative works
 * based upon these libraries are permitted. Any copy of these libraries
 * must include this copyright notice.
 *
 * Written by : R. Et√©
 */


#include "Utils/Numeric.hh"



using namespace std ;



namespace sdhcal {


	double square(double x,double y) {
		return x += y*y;
	}


	std::pair<double,double> linearRegression( vector<double>& x , vector<double>& y ) {

		double avX = accumulate( x.begin() , x.end() , 0.0 ) *1.0 / x.size();
		double avY = accumulate( y.begin() , y.end() , 0.0 ) *1.0 / y.size();
		double avSquareX = accumulate( x.begin() , x.end() , 0.0 , square);

		double squaredSum = 0;

		for(unsigned int i=0 ; i<x.size() ; i++) {
			squaredSum += x.at(i)*y.at(i);
		}

		double a = squaredSum - avX*avY;
		a /= (avSquareX - avX*avX);

		double b = avY - a*avX;
		return make_pair(a,b);
	}

	double gauss2D(double *x, double *par) {

	   double z1 = double((x[0]-par[1])/par[2]);
	   double z2 = double((x[1]-par[3])/par[4]);

	   return par[0]*exp(-0.5*(z1*z1+z2*z2));

	}

	double doubleGauss2D(double *x, double *par) {

	   return gauss2D(x,&par[0]) + gauss2D(x,&par[5]);
	}
}
